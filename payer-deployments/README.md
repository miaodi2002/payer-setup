# Payeréƒ¨ç½²ç®¡ç†ç³»ç»Ÿ

## ç›®å½•ç»“æ„
```
payer-deployments/
â”œâ”€â”€ README.md                          # æ­¤æ–‡ä»¶ï¼šç³»ç»Ÿè¯´æ˜
â”œâ”€â”€ PRODUCTION-DEPLOYMENT-GUIDE.md     # ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ ‡å‡†æµç¨‹
â”œâ”€â”€ CLAUDE-CODE-DEPLOYMENT-GUIDE.md    # Claude Code AIè¾…åŠ©éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ config/                            # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ payer-registry.json            # Payeræ³¨å†Œè¡¨
â”‚   â”œâ”€â”€ deployment-config.json         # éƒ¨ç½²é…ç½®æ¨¡æ¿
â”‚   â”œâ”€â”€ production-variables-*.sh      # è‡ªåŠ¨ç”Ÿæˆçš„ç¯å¢ƒå˜é‡æ–‡ä»¶
â”‚   â””â”€â”€ global-settings.json           # å…¨å±€è®¾ç½®
â”œâ”€â”€ templates/                         # éƒ¨ç½²æ¨¡æ¿
â”‚   â”œâ”€â”€ deployment-plan.md             # éƒ¨ç½²è®¡åˆ’æ¨¡æ¿
â”‚   â”œâ”€â”€ progress-report.md             # è¿›åº¦æŠ¥å‘Šæ¨¡æ¿
â”‚   â””â”€â”€ checklist.md                  # æ£€æŸ¥æ¸…å•æ¨¡æ¿
â”œâ”€â”€ scripts/                           # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ pre-deployment-check.sh        # éƒ¨ç½²å‰ç¯å¢ƒæ£€æŸ¥ (æ–°)
â”‚   â”œâ”€â”€ start-deployment.sh            # æ ‡å‡†åŒ–éƒ¨ç½²å¯åŠ¨å‘å¯¼ (æ–°)
â”‚   â”œâ”€â”€ deploy-payer.sh               # å•ä¸ªPayeréƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ monitor-deployment.sh         # éƒ¨ç½²ç›‘æ§è„šæœ¬
â”‚   â”œâ”€â”€ generate-report.sh            # æŠ¥å‘Šç”Ÿæˆè„šæœ¬
â”‚   â””â”€â”€ cleanup-deployment.sh         # æ¸…ç†è„šæœ¬
â”œâ”€â”€ logs/                             # æ—¥å¿—ç›®å½•
â”‚   â””â”€â”€ {payer-id}/                  # æŒ‰Payer IDç»„ç»‡
â”‚       â”œâ”€â”€ {date}/                  # æŒ‰æ—¥æœŸç»„ç»‡
â”‚       â””â”€â”€ deployment.log           # ä¸»è¦éƒ¨ç½²æ—¥å¿—
â””â”€â”€ reports/                          # æŠ¥å‘Šç›®å½•
    â””â”€â”€ {payer-id}/                  # æŒ‰Payer IDç»„ç»‡
        â”œâ”€â”€ deployment-plan.md        # éƒ¨ç½²è®¡åˆ’
        â”œâ”€â”€ progress-report.md        # è¿›åº¦æŠ¥å‘Š
        â”œâ”€â”€ issues.md                # é—®é¢˜è®°å½•
        â””â”€â”€ completion-summary.md     # å®Œæˆæ€»ç»“
```

## æ ¸å¿ƒåŠŸèƒ½
1. **ç»Ÿä¸€çš„Payerç®¡ç†**: è®°å½•æ‰€æœ‰Payerä¿¡æ¯å’ŒçŠ¶æ€
2. **æ ‡å‡†åŒ–éƒ¨ç½²æµç¨‹**: ä½¿ç”¨æ¨¡æ¿ç¡®ä¿ä¸€è‡´æ€§
3. **å®æ—¶è¿›åº¦è·Ÿè¸ª**: è‡ªåŠ¨åŒ–ç›‘æ§å’ŒæŠ¥å‘Šç”Ÿæˆ
4. **é—®é¢˜è¿½è¸ªå’Œè§£å†³**: é›†ä¸­è®°å½•å’Œè§£å†³æ–¹æ¡ˆ
5. **å†å²è®°å½•å’Œå®¡è®¡**: å®Œæ•´çš„éƒ¨ç½²å†å²

## è¯¦ç»†ä½¿ç”¨æ–¹æ³•

### 1. é…ç½®æ–°çš„Payer
ç¼–è¾‘ `/config/payer-registry.json`ï¼š
```json
{
  "payers": {
    "payer-001": {
      "company": "Example Corp",
      "master_account_email": "admin@example.com",
      "deployment_status": "pending",
      "created_date": "2024-01-15T10:00:00Z"
    }
  }
}
```

### 2. éƒ¨ç½²Payer
```bash
cd payer-deployments

# å®Œæ•´éƒ¨ç½²
./scripts/deploy-payer.sh payer-001

# æ¨¡æ‹Ÿè¿è¡Œï¼ˆæµ‹è¯•ï¼‰
./scripts/deploy-payer.sh payer-001 --dry-run

# éƒ¨ç½²ç‰¹å®šæ¨¡å—
./scripts/deploy-payer.sh payer-001 --module 05-athena-setup

# æŸ¥çœ‹å¸®åŠ©
./scripts/deploy-payer.sh --help
```

### 3. ç›‘æ§éƒ¨ç½²è¿›åº¦
```bash
# æŸ¥çœ‹å½“å‰çŠ¶æ€
./scripts/monitor-deployment.sh payer-001

# å®æ—¶ç›‘æ§æ—¥å¿—
./scripts/monitor-deployment.sh payer-001 logs
```

### 4. ç”ŸæˆæŠ¥å‘Š
```bash
# ç”ŸæˆMarkdownæŠ¥å‘Š
./scripts/generate-report.sh payer-001

# ç”ŸæˆHTMLæŠ¥å‘Š
./scripts/generate-report.sh payer-001 --format html

# ç”ŸæˆJSONæŠ¥å‘Š
./scripts/generate-report.sh payer-001 --format json
```

### 5. æ¸…ç†éƒ¨ç½²
```bash
# äº¤äº’å¼æ¸…ç†
./scripts/cleanup-deployment.sh payer-001

# å¼ºåˆ¶æ¸…ç†
./scripts/cleanup-deployment.sh payer-001 --force

# ä»…æ¸…ç†æ—¥å¿—æ–‡ä»¶
./scripts/cleanup-deployment.sh payer-001 --logs-only

# ä»…æ¸…ç†CloudFormationæ ˆ
./scripts/cleanup-deployment.sh payer-001 --stacks-only

# æ¸…ç†ä½†ä¿ç•™æœ€è¿‘7å¤©çš„æ—¥å¿—
./scripts/cleanup-deployment.sh payer-001 --keep-recent
```

## ğŸš€ æ ‡å‡†åŒ–éƒ¨ç½²æµç¨‹ (æ¨è)

### æ–°çš„æ ‡å‡†åŒ–éƒ¨ç½²æ–¹å¼
1. **ç¯å¢ƒæ£€æŸ¥**: 
   ```bash
   ./scripts/pre-deployment-check.sh
   ```
   - è‡ªåŠ¨æ£€æŸ¥AWSæƒé™å’Œç¯å¢ƒ
   - è‡ªåŠ¨åˆ›å»ºOrganizationsï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
   - ç”Ÿæˆæ ‡å‡†åŒ–ç¯å¢ƒå˜é‡æ–‡ä»¶

2. **å¯åŠ¨éƒ¨ç½²å‘å¯¼**:
   ```bash
   ./scripts/start-deployment.sh <payer-name>
   ```
   - æ˜¾ç¤ºå®Œæ•´çš„éƒ¨ç½²å‘½ä»¤åºåˆ—
   - åŠ è½½ç¯å¢ƒå˜é‡
   - æä¾›å¤åˆ¶ç²˜è´´çš„æ ‡å‡†åŒ–å‘½ä»¤

3. **æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤**:
   - å¤åˆ¶æ˜¾ç¤ºçš„CloudFormationå‘½ä»¤
   - æŒ‰é¡ºåºæ‰§è¡Œæ¯ä¸ªæ¨¡å—
   - ç­‰å¾…æ ¸å¿ƒæ¨¡å—(Module 2)å®Œæˆåå†è¿›è¡Œåç»­æ¨¡å—

### ç¤ºä¾‹ï¼šElite-new11éƒ¨ç½²
```bash
# Step 1: ç¯å¢ƒæ£€æŸ¥
./scripts/pre-deployment-check.sh

# Step 2: è·å–éƒ¨ç½²å‘½ä»¤
./scripts/start-deployment.sh Elite-new11

# Step 3: å¤åˆ¶å¹¶æ‰§è¡Œæ˜¾ç¤ºçš„å‘½ä»¤
# (è„šæœ¬ä¼šæ˜¾ç¤ºæ‰€æœ‰éœ€è¦çš„aws cloudformation create-stackå‘½ä»¤)
```

## ğŸ“‹ ç»å…¸éƒ¨ç½²æ–¹å¼
å¦‚æœéœ€è¦ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ï¼š

### 1. é…ç½®æ–°çš„Payer
ç¼–è¾‘ `/config/payer-registry.json`

### 2. æ‰§è¡Œéƒ¨ç½²
```bash
./scripts/deploy-payer.sh <payer-name>
```

## ğŸ¤– Claude Code AIè¾…åŠ©éƒ¨ç½²

### Claude Codeäº¤äº’éƒ¨ç½²æç¤ºæ¨¡æ¿

å½“æ‚¨éœ€è¦é€šè¿‡Claude Codeè¿›è¡ŒPayeréƒ¨ç½²æ—¶ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹æ ‡å‡†åŒ–æç¤ºæ¨¡æ¿ï¼š

#### 1. æ–°Payeréƒ¨ç½²è¯·æ±‚
```
è¯·å¸®æˆ‘éƒ¨ç½²æ–°çš„Payer: <payer-name>

éƒ¨ç½²è¦æ±‚:
- Payeråç§°: <payer-name>
- è´¦æˆ·ç±»å‹: [æ–°è´¦æˆ·/ç°æœ‰è´¦æˆ·]
- ç‰¹æ®Šè¦æ±‚: [å¦‚æœ‰ä»»ä½•ç‰¹æ®Šé…ç½®éœ€æ±‚]

è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ‰§è¡Œ:
1. è¿è¡Œç¯å¢ƒæ£€æŸ¥è„šæœ¬
2. ç”Ÿæˆæ ‡å‡†åŒ–éƒ¨ç½²å‘½ä»¤
3. é€ä¸ªæ‰§è¡Œæ‰€æœ‰æ¨¡å—çš„éƒ¨ç½²
4. åœ¨æ¯ä¸ªæ¨¡å—å®Œæˆåè¿›è¡ŒéªŒè¯
5. è®°å½•éƒ¨ç½²æ—¥å¿—å’Œè¿›åº¦

å¦‚æœé‡åˆ°ä»»ä½•é”™è¯¯,è¯·åœä¸‹æ¥å‘Šè¯‰æˆ‘å¹¶æä¾›è§£å†³æ–¹æ¡ˆã€‚
```

#### 2. éƒ¨ç½²é—®é¢˜æ’æŸ¥è¯·æ±‚
```
Payer <payer-name> éƒ¨ç½²é‡åˆ°é—®é¢˜:

é”™è¯¯ä¿¡æ¯: [ç²˜è´´å…·ä½“é”™è¯¯ä¿¡æ¯]
å¤±è´¥æ¨¡å—: Module <number>
å½“å‰çŠ¶æ€: [éƒ¨ç½²åˆ°å“ªä¸€æ­¥]

è¯·å¸®åŠ©:
1. åˆ†æé”™è¯¯åŸå› 
2. æä¾›è§£å†³æ–¹æ¡ˆ
3. ç»§ç»­å®Œæˆå‰©ä½™éƒ¨ç½²æ­¥éª¤
```

#### 3. éƒ¨ç½²çŠ¶æ€æ£€æŸ¥è¯·æ±‚
```
è¯·æ£€æŸ¥Payer <payer-name> çš„éƒ¨ç½²çŠ¶æ€:

1. æ£€æŸ¥æ‰€æœ‰CloudFormationæ ˆçŠ¶æ€
2. éªŒè¯å„æ¨¡å—åŠŸèƒ½æ˜¯å¦æ­£å¸¸
3. ç”Ÿæˆå½“å‰éƒ¨ç½²è¿›åº¦æŠ¥å‘Š
4. å¦‚æœ‰é—®é¢˜è¯·æä¾›ä¿®å¤å»ºè®®
```

#### 4. éƒ¨ç½²éªŒè¯è¯·æ±‚
```
Payer <payer-name> éƒ¨ç½²å·²å®Œæˆ,è¯·è¿›è¡Œå…¨é¢éªŒè¯:

éªŒè¯é¡¹ç›®:  
1. æ–°è´¦æˆ·åˆ›å»ºå’ŒBillingGroupé…ç½®
2. Pro formaå’ŒRISP CURè®¾ç½®
3. Athenaæ•°æ®åº“å’Œè¡¨ç»“æ„
4. æ‰€æœ‰CloudFormationæ ˆçŠ¶æ€
5. ç”Ÿæˆæœ€ç»ˆéƒ¨ç½²æŠ¥å‘Š

è¯·ç¡®è®¤æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚
```

### Claude Codeéƒ¨ç½²å·¥ä½œæµç¨‹

Claude Codeåœ¨æ¥åˆ°éƒ¨ç½²è¯·æ±‚åä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹å·¥ä½œæµç¨‹:

1. **ç¯å¢ƒå‡†å¤‡**
   - æ£€æŸ¥å½“å‰å·¥ä½œç›®å½•
   - éªŒè¯AWSå‡­è¯å’Œæƒé™
   - ç¡®è®¤æ¨¡æ¿æ–‡ä»¶å®Œæ•´æ€§

2. **æ‰§è¡Œéƒ¨ç½²**
   - è¿è¡Œpre-deployment-check.sh
   - ç”Ÿæˆç¯å¢ƒå˜é‡å’Œéƒ¨ç½²å‘½ä»¤
   - æŒ‰æ¨¡å—é¡ºåºæ‰§è¡ŒCloudFormationéƒ¨ç½²
   - ç›‘æ§æ¯ä¸ªæ ˆçš„åˆ›å»ºçŠ¶æ€

3. **è¿›åº¦è·Ÿè¸ª**
   - ä½¿ç”¨TodoWriteè·Ÿè¸ªéƒ¨ç½²ä»»åŠ¡
   - å®æ—¶æ›´æ–°éƒ¨ç½²çŠ¶æ€
   - è®°å½•æ‰€æœ‰å‘½ä»¤æ‰§è¡Œç»“æœ

4. **é—®é¢˜å¤„ç†**
   - è‡ªåŠ¨æ£€æµ‹éƒ¨ç½²é”™è¯¯
   - åˆ†æå¤±è´¥åŸå› 
   - æä¾›å…·ä½“è§£å†³æ–¹æ¡ˆ
   - æ”¯æŒä»ä¸­æ–­ç‚¹ç»§ç»­éƒ¨ç½²

5. **éªŒè¯å’ŒæŠ¥å‘Š**
   - éªŒè¯æ‰€æœ‰èµ„æºåˆ›å»ºæˆåŠŸ
   - æ£€æŸ¥åŠŸèƒ½é…ç½®æ­£ç¡®æ€§
   - ç”Ÿæˆè¯¦ç»†çš„éƒ¨ç½²æ—¥å¿—
   - æä¾›åç»­ç»´æŠ¤å»ºè®®

### éƒ¨ç½²è¿‡ç¨‹ä¸­çš„é‡è¦æé†’

- **æƒé™è¦æ±‚**: ç¡®ä¿AWSå‡­è¯å…·æœ‰å®Œæ•´çš„ç®¡ç†å‘˜æƒé™
- **åŒºåŸŸè®¾ç½®**: å¿…é¡»åœ¨us-east-1åŒºåŸŸè¿›è¡Œéƒ¨ç½²
- **ç­‰å¾…æ—¶é—´**: Module 2 (BillingConductor)éœ€è¦30-45åˆ†é’Ÿ
- **é”™è¯¯å¤„ç†**: é‡åˆ°é”™è¯¯æ—¶ä¸è¦è·³è¿‡,å¿…é¡»è§£å†³åç»§ç»­
- **Organizations**: å¦‚æœæ˜¯ç‹¬ç«‹è´¦æˆ·ä¼šè‡ªåŠ¨åˆ›å»ºOrganizations
- **BillingGroupåç§°**: æ–°åˆ›å»ºçš„BillingGroupä¼šä½¿ç”¨"Bills"ä½œä¸ºåç§°

### å¸¸ç”¨çš„Claude CodeæŒ‡ä»¤

```bash
# è®©Claude Codeæ£€æŸ¥ç¯å¢ƒ
è¯·è¿è¡Œ ./scripts/pre-deployment-check.sh å¹¶å‘Šè¯‰æˆ‘ç»“æœ

# è®©Claude Codeå¼€å§‹éƒ¨ç½²
è¯·ä¸º <payer-name> è¿è¡Œæ ‡å‡†åŒ–éƒ¨ç½²æµç¨‹

# è®©Claude Codeæ£€æŸ¥æ ˆçŠ¶æ€  
è¯·æ£€æŸ¥æ‰€æœ‰CloudFormationæ ˆçš„å½“å‰çŠ¶æ€

# è®©Claude Codeä¿®å¤é—®é¢˜
<payer-name> çš„Module Xéƒ¨ç½²å¤±è´¥,é”™è¯¯æ˜¯: [é”™è¯¯ä¿¡æ¯], è¯·å¸®åŠ©ä¿®å¤

# è®©Claude Codeç”ŸæˆæŠ¥å‘Š
è¯·ä¸º <payer-name> ç”Ÿæˆå®Œæ•´çš„éƒ¨ç½²çŠ¶æ€æŠ¥å‘Š
```

### ğŸ“š è¯¦ç»†æŒ‡å—æ–‡æ¡£

- **[CLAUDE-CODE-DEPLOYMENT-GUIDE.md](./CLAUDE-CODE-DEPLOYMENT-GUIDE.md)**: Claude Code AIè¾…åŠ©éƒ¨ç½²å®Œæ•´æŒ‡å—
  - è¯¦ç»†çš„æç¤ºæ¨¡æ¿
  - é«˜çº§äº¤äº’å‘½ä»¤
  - é”™è¯¯å¤„ç†ç­–ç•¥
  - æœ€ä½³å®è·µå»ºè®®

- **[PRODUCTION-DEPLOYMENT-GUIDE.md](./PRODUCTION-DEPLOYMENT-GUIDE.md)**: ç”Ÿäº§ç¯å¢ƒæ ‡å‡†éƒ¨ç½²æµç¨‹
  - æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤
  - ç¯å¢ƒéªŒè¯æ¸…å•
  - æ•…éšœæ’é™¤æŒ‡å—

## ä¼°ç®—ä¿¡æ¯
- **å•ä¸ªPayeréƒ¨ç½²æ—¶é—´**: 2-3å°æ—¶
- **å¹¶è¡Œéƒ¨ç½²èƒ½åŠ›**: å»ºè®®æœ€å¤š3ä¸ª
- **èµ„æºéœ€æ±‚**: ä¸­ç­‰ï¼ˆCloudFormationæ ˆåˆ›å»ºï¼‰
- **é£é™©ç­‰çº§**: ä½-ä¸­ç­‰ï¼ˆå·²æµ‹è¯•çš„æ¨¡æ¿ï¼‰